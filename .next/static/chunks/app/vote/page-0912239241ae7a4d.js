(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[915],{829:()=>{},1080:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var a=s(5155);function i(){return(0,a.jsx)("footer",{className:"footer",children:(0,a.jsxs)("p",{children:["Built with ",(0,a.jsx)("span",{className:"heart",children:"❤️"})," by Harun"]})})}},5281:(e,t,s)=>{Promise.resolve().then(s.bind(s,9676))},9676:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var a=s(5155),i=s(2115);s(829);var n=s(1080),l=s(9744);function c(){let[e,t]=(0,i.useState)(""),[s,l]=(0,i.useState)(!1),[c,r]=(0,i.useState)({}),[o,d]=(0,i.useState)({}),[h,u]=(0,i.useState)({}),[m,p]=(0,i.useState)(!1),[v,j]=(0,i.useState)(""),[f,N]=(0,i.useState)(!1),[b,x]=(0,i.useState)(!1),[y,g]=(0,i.useState)([]);(0,i.useEffect)(()=>{let e=async()=>{try{let e=await fetch("http://localhost:3001/api/results");if(e.ok){let t=await e.json();u(t.votes)}else j("Failed to fetch election results.")}catch(e){j("Error connecting to the server.")}};(async()=>{try{let e=await fetch("http://localhost:3001/api/candidates");if(e.ok){let t=await e.json();g(t)}else j("Failed to load candidates.")}catch(e){j("Error connecting to the server.")}})(),e()},[]);let k=(0,i.useCallback)(async()=>{if(!e.trim())return void j("Please enter a valid departmental ID.");x(!0);try{let t=await fetch("http://localhost:3001/api/validate-voter",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({voterId:e.trim()})}),s=await t.json();t.ok&&s.isEligible?(l(!0),d(s.hasVoted||{}),j("")):(j(s.error||"Only candidates with a valid departmental ID can vote."),l(!1))}catch(e){j("Error connecting to the server.")}finally{x(!1)}},[e]),S=(0,i.useCallback)(async()=>{if(!s)return void j("Please verify your departmental ID first.");let t=Object.keys(c);if(0===t.length||t.every(e=>!c[e]))return void j("Please select at least one candidate.");x(!0);try{let t=await fetch("http://localhost:3001/api/submit-vote",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({voterId:e,selectedCandidates:c})}),s=await t.json();t.ok?(u(s.votes),d(s.hasVoted[e]),p(!0),N(!0),setTimeout(()=>N(!1),3e3),j("")):j(s.error||"Vote submission failed.")}catch(e){j("Error connecting to the server.")}finally{x(!1)}},[s,c,e]),w=(0,i.useCallback)(async()=>{x(!0);try{if((await fetch("http://localhost:3001/api/reset",{method:"POST",headers:{"Content-Type":"application/json"}})).ok){let e=y.reduce((e,t)=>(e[t.position]||(e[t.position]={}),e[t.position][t.id]=0,e),{});u(e),d({}),r({}),p(!1),t(""),l(!1),j("")}else j("Failed to reset election.")}catch(e){j("Error connecting to the server.")}finally{x(!1)}},[y]),C=[...new Set(y.map(e=>e.position))];return(0,a.jsxs)("div",{className:"container",children:[f&&(0,a.jsx)("div",{className:"confetti"}),(0,a.jsx)("h1",{className:"page-title",children:"NACOS Election Voting"}),v&&(0,a.jsx)("p",{className:"error-message",children:v}),s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("p",{className:"section-subtitle",children:["Candidate ID: ",e]}),C.map(e=>(0,a.jsxs)("div",{className:"position-section",children:[(0,a.jsx)("h2",{className:"section-title",children:e}),(0,a.jsx)("div",{className:"candidate-grid",children:y.filter(t=>t.position===e).map(t=>(0,a.jsxs)("div",{className:"candidate-card",children:[(0,a.jsx)("img",{src:t.avatar,alt:t.name,className:"candidate-avatar"}),(0,a.jsxs)("div",{className:"candidate-info",children:[(0,a.jsx)("input",{type:"radio",name:e,value:t.id,disabled:o[e],onChange:()=>r({...c,[e]:parseInt(t.id)}),checked:c[e]===t.id,className:"candidate-radio"}),(0,a.jsx)("label",{className:"candidate-label",children:t.name})]})]},t.id))}),o[e]&&(0,a.jsxs)("p",{className:"vote-message",children:["Voted for ",e,"!"]})]},e)),(0,a.jsx)("button",{className:"vote-btn ".concat(Object.keys(o).length===C.length||b?"disabled":""),onClick:S,disabled:Object.keys(o).length===C.length||b,children:b?"Submitting...":"Submit Votes"}),m&&(0,a.jsxs)("div",{className:"results-section",children:[(0,a.jsx)("h2",{className:"section-title",children:"Election Results"}),C.map(e=>(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"section-subtitle",children:e}),(0,a.jsx)("div",{className:"results",children:y.filter(t=>t.position===e).map(t=>{var s,i;return(0,a.jsxs)("div",{className:"result-item",children:[(0,a.jsx)("span",{children:t.name}),(0,a.jsxs)("div",{className:"vote-bar",style:{width:"".concat(10*((null==(s=h[e])?void 0:s[t.id])||0),"%")},children:[(null==(i=h[e])?void 0:i[t.id])||0," votes"]})]},t.id)})})]},e)),(0,a.jsx)("button",{className:"reset-btn",onClick:w,disabled:b,children:"Reset Election"})]})]}):(0,a.jsxs)("div",{className:"voter-id-section",children:[(0,a.jsx)("p",{className:"section-subtitle",children:"Enter your  departmental ID NUMBER:"}),(0,a.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"e.g., 22/08/05/0001",className:"voter-id-input"}),(0,a.jsx)("button",{className:"cta-btn",onClick:k,disabled:b,children:b?"Verifying...":"Verify ID"})]}),(0,a.jsx)(n.A,{})]})}fetch("".concat(l.J,"/api/candidates"))},9744:(e,t,s)=>{"use strict";s.d(t,{J:()=>a});let a="https://nacos-election-portal-5.onrender.com"}},e=>{e.O(0,[562,441,255,358],()=>e(e.s=5281)),_N_E=e.O()}]);