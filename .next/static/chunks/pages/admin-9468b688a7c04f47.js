(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[309],{311:(e,t,a)=>{"use strict";a.d(t,{J:()=>s});let s="https://nacos-election-portal-5.onrender.com"},6999:()=>{},8210:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin",function(){return a(9591)}])},9591:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c});var s=a(7876),i=a(4232);a(6999);var n=a(311);function c(){let[e,t]=(0,i.useState)(""),[a,c]=(0,i.useState)(!1),[l,o]=(0,i.useState)({}),[r,d]=(0,i.useState)([]),[u,h]=(0,i.useState)(""),[m,p]=(0,i.useState)(""),[v,f]=(0,i.useState)(""),[g,j]=(0,i.useState)(!1);(0,i.useEffect)(()=>{let e=async()=>{try{if((await fetch("".concat(n.J,"/api/election-status"))).ok){let e=await fetch("".concat(n.J,"/api/election-config"));if(e.ok){let t=await e.json();h(t.startTime.slice(0,16)),p(t.endTime.slice(0,16))}else f("Failed to load election config.")}else f("Failed to fetch election status.")}catch(e){f("Error connecting to the server.")}};(async()=>{try{let e=await fetch("".concat(n.J,"/api/candidates"));e.ok?d(await e.json()):f("Failed to load candidates.")}catch(e){f("Error connecting to the server.")}})(),a&&e()},[a]);let N=async()=>{if("admin123"===e){c(!0),f("");try{let e=await fetch("".concat(n.J,"/api/results"));e.ok?o((await e.json()).votes):f("Failed to load results.")}catch(e){f("Error connecting to the server.")}}else f("Invalid password.")},x=async()=>{j(!0);try{(await fetch("".concat(n.J,"/api/update-votes"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({votes:l,adminPassword:e})})).ok?(f(""),alert("Votes updated successfully!")):f("Failed to update votes.")}catch(e){f("Error connecting to the server.")}finally{j(!1)}},y=async()=>{j(!0);try{let t=await fetch("".concat(n.J,"/api/update-config"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({startTime:u,endTime:m,adminPassword:e})});if(t.ok)f(""),alert("Election times updated successfully!");else{let e=await t.json();f(e.error||"Failed to update election times.")}}catch(e){f("Error connecting to the server.")}finally{j(!1)}},w=[...new Set(r.map(e=>e.position))];return(0,s.jsxs)("div",{className:"container",children:[(0,s.jsx)("h1",{className:"page-title",children:"NACOS Election Admin"}),a?(0,s.jsxs)("div",{className:"admin-panel",children:[v&&(0,s.jsx)("p",{className:"error-message",children:v}),(0,s.jsxs)("div",{className:"config-section",children:[(0,s.jsx)("h3",{className:"section-subtitle",children:"Election Schedule"}),(0,s.jsxs)("div",{className:"config-item",children:[(0,s.jsx)("label",{children:"Start Time:"}),(0,s.jsx)("input",{type:"datetime-local",value:u,onChange:e=>h(e.target.value),className:"config-input"})]}),(0,s.jsxs)("div",{className:"config-item",children:[(0,s.jsx)("label",{children:"End Time:"}),(0,s.jsx)("input",{type:"datetime-local",value:m,onChange:e=>p(e.target.value),className:"config-input"})]}),(0,s.jsx)("button",{onClick:y,disabled:g,className:"submit-button",children:g?"Saving...":"Save Election Times"})]}),(0,s.jsxs)("div",{className:"vote-section",children:[(0,s.jsx)("h3",{className:"section-subtitle",children:"Manage Votes"}),w.map(e=>(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"section-subtitle",children:e}),r.filter(t=>t.position===e).map(t=>{var a;return(0,s.jsxs)("div",{className:"vote-item",children:[(0,s.jsx)("span",{children:t.name}),(0,s.jsx)("input",{type:"number",min:"0",value:(null==(a=l[e])?void 0:a[t.id])||0,onChange:a=>{var s,i;return s=t.id,i=a.target.value,void o(t=>({...t,[e]:{...t[e],[s]:parseInt(i)||0}}))},className:"vote-input"})]},t.id)})]},e)),(0,s.jsx)("button",{onClick:x,disabled:g,className:"submit-button",children:g?"Saving...":"Save Vote Changes"})]})]}):(0,s.jsxs)("div",{className:"admin-login",children:[(0,s.jsx)("input",{type:"password",value:e,onChange:e=>t(e.target.value),placeholder:"Enter admin password",className:"password-input"}),(0,s.jsx)("button",{onClick:N,className:"submit-button",children:"Login"}),v&&(0,s.jsx)("p",{className:"error-message",children:v})]})]})}}},e=>{e.O(0,[636,593,792],()=>e(e.s=8210)),_N_E=e.O()}]);